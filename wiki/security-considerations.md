
This page outlines key security considerations to be taken into account when designing a new timesheeting system.

The following table provides an overview of security risks and mitigations as currently understood, based on the outline technology approach.


| Risk | Definition | Mitigation |
| ---- | ---------- | ---------- |
| Data in transit | Data in transit must be appropriately secured | The API would be https-only, ensuring encryption of data in transit
| Data at rest | Data at rest at rest must be appropriately secured | For data at rest, this would be relevant for offline use of a mobile device for timesheet entry.<br><br>No data would need to be stored on the device for ITL functions of timesheet review across a cluster of plants unless a need is identified to provide this as an offline function. |
| Data aggregation | The impact of data loss is related to the scope of data stored on a device (broader scope means more data held) | Only the authenticated user's entries would be stored and only until they have been successfully transmitted to the API. |
| Data retention | The impact of data loss is related to the amount of time that data remain on a device (longer retention means more data held) | Offline timesheet entries would only be held until such time as they have been successfully transmitted to the API. |
| Reputation risk | The data processed by the timesheeting API could be considered commercially sensitive by FBOs | The data visible to ITLs could be considered commercially sensitive as it provides an overview of inspection activity at the level of a cluster of plants. Therefore ITL access may need to be more closely monitored than individual timesheet entry access. This is mitigated to an extent by no offline data needing to be stored on a device for ITL usage
| Device compromise - data | Appropriate controls are needed in order to have assurance about device security. This applies to any residual data stored locally on a device. | If strong protection is required for data at rest on the device, encryption can be implemented at the application level. This would add complexity so ideally native features of the mobile OS (expected to be Android) would suffice, given the scope, volume and longevity of data.
| Device compromise - access token | Appropriate controls are needed in order to have assurance about device security. | This applies to any access token stored on the device that is used to authenticate with the API and authorise access to timesheeting data and functionality via the API<br><br>The functions provided by the API can be limited, reducing the scope of available actions and the amount of data that can be accessed, e.g. only timesheet entry, review and reconciliation and only for data relevant to the authenticated user.<br><br>Where functions that require a broad scope of data access are needed to fulfil user needs, e.g. for back-office processes such as charging, these would be made accessible from within the food.gov domain only. |
| Device compromise - access token (MHI/OV) | Appropriate controls are needed in order to have assurance about device security. | The impact of a compromised inspector-grade token would be that an unauthorised user is able to enter timesheet information. This is mitigated by the ITL review process |
| Device compromise - access token (ITL) | Appropriate controls are needed in order to have assurance about device security. | The impact of a compromised ITL-grade token would be that an unauthorised user is able to review and reject timesheets for the plants that the ITL oversees. <br><br>This can be mitigated by having ITLs notify FSA of a lost or stolen device, by providing a "global logout" to revoke all token IDs for a user and through technical controls to monitor token use |
| Managed or unmanaged device | Depending on the assurance that can be provided for device security, a corporately managed device may be required (issued by FSA or an SDP) or it may be possible to allow personal devices | If controls can be put in place that enable timesheeting to be used from unmanaged devices, this reduces the supportability burden from the full device to the timesheeting application. This should also reduce risk and cost, both in terms of hardware and in terms of the processes and infrastructure needed to issue and manage corporate devices. |
| Complexity risk | It is important to consider overall system complexity for both security and supportability of timesheeting and ensure it is a workable service | Minimising the complexity of processes, technology systems and overall solution design will be important in mitigating risk and detecting unauthorised use |
| Citrix remote access | Citrix access into the food.gov domain is seen as a risk. | Moving away from Citrix remote access for accessing timesheeting to a model that uses an external API (appropriately secured to Internet standards) would reduce the level of privilege afforded by access to timesheeting. |
| Infrastructure risk | There are risks from remote access infrastructure allowing ingress from plants to the FSA network, including thin clients, routers and internet connection provision. | Minimising the amount of FSA-provided infrastructure components and complexity involved in user access to timesheeting should reduce overall infrastructure risk |
| Usability risk | Current levels of friction in accessing timesheeting create security risk through usability, such as leaving a terminal unattended whilst waiting for login to complete | Reducing friction to access timesheeting, improving overall performance of the system from a user perspective and improving usability and user experience design mitigates in-practice/contextual risks that can be triggered by strong technical controls |

## API authentication risks

* Authentication and authorisation of users could be provided via digitally-signed [RFC 7519 JSON Web Tokens (jwt)](https://tools.ietf.org/html/rfc7519). This mechanism provides a flexible and comprehensive data structure based on [claims](https://auth0.com/docs/tokens/jwt-claims), stateless operation and non-repudiation via digital signature (both symmetric and public-private key options are available).
 * Risk vectors of token loss and token compromise can be mitigated through a token refresh cycle ([exp](https://auth0.com/docs/tokens/jwt-claims#reserved-claims) claim) coupled with a revocation method based on token ID ([jti](https://auth0.com/docs/tokens/jwt-claims#reserved-claims) claim).
 * Infrastructure-level protection, such as [Azure Application Gateway](https://docs.microsoft.com/en-us/azure/application-gateway/overview) can be designed into the system deployment. Application Gateway can optionally provide [Web Application Firewall (WAF)](https://docs.microsoft.com/en-gb/azure/application-gateway/waf-overview) features.




